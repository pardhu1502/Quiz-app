<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/style.css">

<%- include('partials/header') %>
<div class="container my-4">
  <div class="progress mb-4">
    <div id="quizProgress" class="progress-bar progress-bar-striped bg-success" style="width: 0%;">0%</div>
  </div>
  <form method="POST" action="/quiz/submit">
    <% questions.forEach((q, i) => { %>
      <div class="card p-3 mb-4 shadow-sm question-card" data-question="<%= i %>">
        <p><strong>Q<%= i+1 %>:</strong> <%= q.question %></p>
        <% q.options.forEach(opt => { %>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q<%= i %>" value="<%= opt %>" required>
            <label class="form-check-label"><%= opt %></label>
          </div>
        <% }) %>
      </div>
    <% }) %>
    <button class="btn btn-primary">Submit Quiz</button>
  </form>
</div>

<script>
  const totalQuestions = '<%= questions.length %>';
  const inputs = document.querySelectorAll('input[type=radio]');
  const progressBar = document.getElementById('quizProgress');
  const answered = new Set();

  inputs.forEach(input => {
    input.addEventListener('change', () => {
      const qIndex = +input.name.replace('q', '');
      answered.add(qIndex);
      const percent = Math.round((answered.size / totalQuestions) * 100);
      progressBar.style.width = percent + '%';
      progressBar.textContent = percent + '%';
    });
  });
</script>
